[{"path":"https://gpitt71.github.io/clmplus/articles/casestudy1.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Case study part 1","text":"clmplus package provides practitioners fast user friendly implementation modeling framework derived paper Pittarello G., Hiabu M., Villegas ., Replicating extending chain-ladder via age-period-cohort structure claim development run-triangle, (pre-print, 2022). able connect well-known hazard models developed life insurance non-life run-triangles claims development. flexibility approach goes beyond methodological novelty: hope provide user-friendly set tools based point contact non-life insurance life insurance actuarial science. vignette organized follows: show connection age-period representation run-triangles. replicate chain-ladder model age-model. shown paper, using clmplus approach resulting model saving parameters respect standard GLM approach. show example adding cohort effect can lead improvement model fit. tutorial, show example AutoBIPaid run-triangle ChainLadder package.","code":""},{"path":"https://gpitt71.github.io/clmplus/articles/casestudy1.html","id":"one-discipline-one-language","dir":"Articles","previous_headings":"Introduction","what":"One discipline, one language","title":"Case study part 1","text":"Consider data set chose tutorial. run-triangle representation displayed : Practitioners general insurance refer x axis representation development years. Similarly, y axis called accident years. third dimension matters diagonals: calendar years. one--one correspondence age-period representation run-triangles. notional terms, life insurance actuaries use following terminology: ages development years. cohorts accident years. periods calendar years. Indeed, age-period representation run-triangle following: Observe y axis now development years (age) component. Calendar years (periods) displayed x axis. Accident years (cohorts) diagonals.","code":"library(ChainLadder)  data(\"AutoBI\") dataset=AutoBI$AutoBIPaid  dataset #>      [,1] [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8] #> [1,] 1904 5398  7496  8882  9712 10071 10199 10256 #> [2,] 2235 6261  8691 10443 11346 11754 12031    NA #> [3,] 2441 7348 10662 12655 13748 14235    NA    NA #> [4,] 2503 8173 11810 14176 15383    NA    NA    NA #> [5,] 2838 8712 12728 15278    NA    NA    NA    NA #> [6,] 2405 7858 11771    NA    NA    NA    NA    NA #> [7,] 2759 9182    NA    NA    NA    NA    NA    NA #> [8,] 2801   NA    NA    NA    NA    NA    NA    NA  colnames(dataset)=c(0:(dim(dataset)[1]-1)) rownames(dataset)=c(0:(dim(dataset)[1]-1)) #>      [,1] [,2] [,3] [,4]  [,5]  [,6]  [,7]  [,8] #> [1,] 1904 2235 2441 2503  2838  2405  2759  2801 #> [2,]   NA 5398 6261 7348  8173  8712  7858  9182 #> [3,]   NA   NA 7496 8691 10662 11810 12728 11771 #> [4,]   NA   NA   NA 8882 10443 12655 14176 15278 #> [5,]   NA   NA   NA   NA  9712 11346 13748 15383 #> [6,]   NA   NA   NA   NA    NA 10071 11754 14235 #> [7,]   NA   NA   NA   NA    NA    NA 10199 12031 #> [8,]   NA   NA   NA   NA    NA    NA    NA 10256"},{"path":"https://gpitt71.github.io/clmplus/articles/casestudy1.html","id":"replicate-the-chain-ladder-with-the-clmplus-package","dir":"Articles","previous_headings":"","what":"Replicate the chain-ladder with the clmplus package","title":"Case study part 1","text":"clmplus --box set tools compute claims reserve. now show replicate chain ladder model. Observe run-triangle data structure first needs initialized AggregateDataPP object. Starting results paper showed replicate chain ladder age model. computation AggregateDataPP object obtained method clmplus specifying hazard model. clmplus method, estimates models parameters. fitted model, possible extract fitted development factors: also possible extract fitted effects claims development. Predictions can computed predict method. predict method, can extract predicted development factors, full lower triangle predicted cumulative claims. Interestingly provide predictions different forecasting horizons. predictions one calendar period. can specified forecasting_horizon argument. show consistency approach comparing estimates obtained Mack chain ladder method implemented ChainLadder package. Estimates gathered data.frame ease understanding.","code":"a.model.fit=clmplus(AggregateDataPP =  rtt,               hazard.model = \"a\") #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm a.model.fit$fitted_development_factors #>      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8] #> [1,]   NA 3.098156 1.443611 1.195516 1.087378 1.036028 1.018557 1.005589 #> [2,]   NA 3.098156 1.443611 1.195516 1.087378 1.036028 1.018557       NA #> [3,]   NA 3.098156 1.443611 1.195516 1.087378 1.036028       NA       NA #> [4,]   NA 3.098156 1.443611 1.195516 1.087378       NA       NA       NA #> [5,]   NA 3.098156 1.443611 1.195516       NA       NA       NA       NA #> [6,]   NA 3.098156 1.443611       NA       NA       NA       NA       NA #> [7,]   NA 3.098156       NA       NA       NA       NA       NA       NA #> [8,]   NA       NA       NA       NA       NA       NA       NA       NA a.model.fit$fitted_effects #> $fitted_development_effect #>           0           1           2           3           4           5  #>          NA  0.02366899 -1.01313612 -1.72538123 -2.48027780 -3.34130515  #>           6           7  #> -3.99615988 -5.18978418  #>  #> $fitted_calendar_effect #> NULL #>  #> $fitted_accident_effect #> NULL a.model <- predict(a.model.fit) a.model$development_factors_predicted #>      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8] #> [1,]   NA       NA       NA       NA       NA       NA       NA       NA #> [2,]   NA       NA       NA       NA       NA       NA       NA 1.005589 #> [3,]   NA       NA       NA       NA       NA       NA 1.018557 1.005589 #> [4,]   NA       NA       NA       NA       NA 1.036028 1.018557 1.005589 #> [5,]   NA       NA       NA       NA 1.087378 1.036028 1.018557 1.005589 #> [6,]   NA       NA       NA 1.195516 1.087378 1.036028 1.018557 1.005589 #> [7,]   NA       NA 1.443611 1.195516 1.087378 1.036028 1.018557 1.005589 #> [8,]   NA 3.098156 1.443611 1.195516 1.087378 1.036028 1.018557 1.005589 a.model$lower_triangle #>      [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8] #> [1,]   NA       NA       NA       NA       NA       NA       NA       NA #> [2,]   NA       NA       NA       NA       NA       NA       NA 12098.24 #> [3,]   NA       NA       NA       NA       NA       NA 14499.15 14580.19 #> [4,]   NA       NA       NA       NA       NA 15937.22 16232.97 16323.69 #> [5,]   NA       NA       NA       NA 16612.95 17211.49 17530.88 17628.86 #> [6,]   NA       NA       NA 14072.42 15302.04 15853.34 16147.53 16237.77 #> [7,]   NA       NA 13255.24 15846.86 17231.52 17852.34 18183.62 18285.24 #> [8,]   NA 8677.936 12527.57 14976.91 16285.56 16872.30 17185.39 17281.44 a.model$full_triangle #>      0        1        2        3        4        5        6        7 #> 0 1904 5398.000  7496.00  8882.00  9712.00 10071.00 10199.00 10256.00 #> 1 2235 6261.000  8691.00 10443.00 11346.00 11754.00 12031.00 12098.24 #> 2 2441 7348.000 10662.00 12655.00 13748.00 14235.00 14499.15 14580.19 #> 3 2503 8173.000 11810.00 14176.00 15383.00 15937.22 16232.97 16323.69 #> 4 2838 8712.000 12728.00 15278.00 16612.95 17211.49 17530.88 17628.86 #> 5 2405 7858.000 11771.00 14072.42 15302.04 15853.34 16147.53 16237.77 #> 6 2759 9182.000 13255.24 15846.86 17231.52 17852.34 18183.62 18285.24 #> 7 2801 8677.936 12527.57 14976.91 16285.56 16872.30 17185.39 17281.44 a.model.2 <- predict(a.model.fit,                      forecasting_horizon=1) mck.chl <- MackChainLadder(dataset) ultimate.chl=mck.chl$FullTriangle[,dim(mck.chl$FullTriangle)[2]] diagonal=rev(t2c(mck.chl$FullTriangle)[,dim(mck.chl$FullTriangle)[2]]) data.frame(ultimate.cost.mack=ultimate.chl,            ultimate.cost.clmplus=a.model$ultimate_cost,            reserve.mack=ultimate.chl-diagonal,            reserve.clmplus=a.model$reserve            ) #>   ultimate.cost.mack ultimate.cost.clmplus reserve.mack reserve.clmplus #> 0           10256.00              10256.00      0.00000         0.00000 #> 1           12098.24              12098.24     67.23865        67.23865 #> 2           14580.19              14580.19    345.18727       345.18727 #> 3           16323.69              16323.69    940.68770       940.68770 #> 4           17628.86              17628.86   2350.85562      2350.85562 #> 5           16237.77              16237.77   4466.77443      4466.77443 #> 6           18285.24              18285.24   9103.24335      9103.24335 #> 7           17281.44              17281.44  14480.43832     14480.43832  cat('\\n Total reserve:',     sum(a.model$reserve)) #>  #>  Total reserve: 31754.43"},{"path":"https://gpitt71.github.io/clmplus/articles/casestudy1.html","id":"claims-reserving-with-glms-compared-to-hazard-models","dir":"Articles","previous_headings":"Replicate the chain-ladder with the clmplus package","what":"Claims reserving with GLMs compared to hazard models","title":"Case study part 1","text":"fit standard GLM model apc package. shown paper chain-ladder model can replicated fitting age-cohort model. Inspect model coefficients derived output: method able replicate chain-ladder results need add cohort component. inspection can performed clmplus package, provides graphical tools inspect fitted effects. Observe model rate continuous time, choice line plot consistent.","code":"library(apc)  ds.apc = apc.data.list(cum2incr(dataset),                        data.format = \"CL\")  ac.model.apc = apc.fit.model(ds.apc,                          model.family = \"od.poisson.response\",                          model.design = \"AC\") ac.model.apc$coefficients.canonical[,'Estimate'] #>        level    age slope cohort slope     DD_age_3     DD_age_4     DD_age_5  #>   7.41596168   0.74105900   0.16519698  -1.16411707  -0.02909890  -0.17467013  #>     DD_age_6     DD_age_7     DD_age_8  DD_cohort_3  DD_cohort_4  DD_cohort_5  #>  -0.17533888   0.17408744  -0.55360421   0.02140672  -0.07364998  -0.03603392  #>  DD_cohort_6  DD_cohort_7  DD_cohort_8  #>  -0.15911660   0.20095088  -0.17521544  ac.fcst.apc = apc.forecast.ac(ac.model.apc)  data.frame(reserve.mack=ultimate.chl-diagonal,            reserve.apc=c(0,ac.fcst.apc$response.forecast.coh[,'forecast']),            reserve.clmplus=a.model$reserve                        ) #>   reserve.mack reserve.apc reserve.clmplus #> 0      0.00000     0.00000         0.00000 #> 1     67.23865    67.23865        67.23865 #> 2    345.18727   345.18727       345.18727 #> 3    940.68770   940.68770       940.68770 #> 4   2350.85562  2350.85562      2350.85562 #> 5   4466.77443  4466.77443      4466.77443 #> 6   9103.24335  9103.24335      9103.24335 #> 7  14480.43832 14480.43832     14480.43832 a.model.fit$fitted_effects #> $fitted_development_effect #>           0           1           2           3           4           5  #>          NA  0.02366899 -1.01313612 -1.72538123 -2.48027780 -3.34130515  #>           6           7  #> -3.99615988 -5.18978418  #>  #> $fitted_calendar_effect #> NULL #>  #> $fitted_accident_effect #> NULL plot(a.model)"},{"path":"https://gpitt71.github.io/clmplus/articles/casestudy1.html","id":"the-benefitial-effect-of-adding-the-cohort-component","dir":"Articles","previous_headings":"","what":"The benefitial effect of adding the cohort component","title":"Case study part 1","text":"straightforward state statistical perspective desirable model less parameters. Nevertheless, approach goes far beyond . adding cohort effect able improve modeling. show results inspecting residuals plots.  Clearly, red blue areas suggest trends model wasn’t able catch. Consider now age-cohort model residuals plot.  need extrapolating period component, able improve fit already. Pay attention, cohort component cohort m extrapolated.","code":"#make it triangular plot(a.model.fit) ac.model.fit <- clmplus(rtt,                      hazard.model=\"ac\") #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm  ac.model <- predict(ac.model.fit,                     gk.fc.model='a') plot(ac.model.fit) plot(ac.model)"},{"path":"https://gpitt71.github.io/clmplus/articles/casestudy1.html","id":"extrapolation-of-a-period-component","dir":"Articles","previous_headings":"The benefitial effect of adding the cohort component","what":"Extrapolation of a period component","title":"Case study part 1","text":"Similarly, possible add period component choose age-period model age-period-cohort model.  can seen age-period model suggest serious improvement age-cohort model. worth noticing one time age-cohort model require extrapolation. similar fashion, plot age-period-cohort model , seems lead us small improvement.  , effects age-period-cohort model.","code":"ap.model.fit = clmplus(rtt,                    hazard.model = \"ap\") #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm  ap.model<-predict(ap.model.fit,                     ckj.fc.model='a',                    ckj.order = c(0,1,0))  apc.model.fit = clmplus(rtt,hazard.model = \"apc\") #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm  apc.model<-predict(apc.model.fit,                     gk.fc.model='a',                     ckj.fc.model='a',                    gk.order = c(1,1,0),                    ckj.order = c(0,1,0)) plot(ap.model.fit) plot(apc.model.fit) plot(apc.model)"},{"path":"https://gpitt71.github.io/clmplus/articles/casestudy1.html","id":"conclusions","dir":"Articles","previous_headings":"","what":"Conclusions","title":"Case study part 1","text":"vignette wanted show flexibility modeling approach respect well-known chain-ladder model. modeling hazard rate able replicate chain-ladder results less parameters. Indeed, model age component directly add cohort effect needed. Going age model age-cohort model may lead serious improvement model results.","code":""},{"path":"https://gpitt71.github.io/clmplus/articles/modelscomparison.html","id":"bake-off","dir":"Articles","previous_headings":"","what":"Bake-off","title":"Models comparison","text":"Within section provide code measure models extrapolation accuracy. order , need coherently split data set training, validation testing. show example 12x12 run-triangle.  models clmplus package compared apc package. can found code used create bake-plot paper.  detail, three set disposal, case able pick best model based error incidence.","code":"J=12 df<-data.frame(expand.grid(c(0:(J-1)),c(0:(J-1))),c(1:(J^2))) colnames(df) <- c(\"origin\",\"dev\",\"value\") df$value[df$origin+df$dev==(J-1)]=c(3) df$value[df$origin+df$dev<(J-2)]=c(1) df$value[df$origin+df$dev==(J-2)]=c(2) df$value[df$origin+df$dev>=J]=c(NA) #nas in the lower df[J,3]=c(NA) df[J-1,3]=c(NA) df[J+J-1,3]=c(NA) df[J*J-J+1,3]=c(NA) df[J*J-J+1,3]=c(NA) #nas in the upper tail df[J*J-J+1-12,3]=c(NA) df[J*J-J+2-12,3]=c(NA)  ggplot(data=df, aes(x=as.integer(dev), y=as.integer(origin))) +    geom_tile(aes(fill = as.factor(value),color=\"#000000\"))+scale_y_reverse()+   scale_fill_manual(values=c(\"royalblue\", \"darkred\", \"darkgreen\",\"white\"),                     na.value = \"white\",                     labels=c(\"Train\",\"Validation\",\"Test\",\"\"))+   theme_classic()+   labs(x=\"Development year\", y=\"Accident year\",fill=\"\")+   theme(axis.title.x = element_text(size=8), axis.text.x  = element_text(size=7))+   theme(axis.title.y = element_text(size=8), axis.text.y  = element_text(size=7))+   scale_color_brewer(guide = 'none') best.of.the.bests <- function(df1,df2){   \"   Util to turn character columns values into numeric.   \"      df1=apply(df1,MARGIN=2,FUN=as.numeric)   df2=apply(df2,MARGIN=2,FUN=as.numeric)   df3 <- rbind(df1,df2)   df3=apply(df3,FUN=abs.min,MARGIN = 2)      return(df3)    }  modelcomparison.1d <- function(cumulative.payments.triangle){   \"   Function to compare the clmplus package age-period-cohort models with apc package age-period-cohort models  performances across different triangles.      This function takes a triangle of cumulative payments as input.      It returns the accuracy measures for the two families on the triangle.   \"   # function internal variables      leave.out=2      rmse = NULL   mae = NULL   error.pc = NULL   model.name = NULL   error.incidence = NULL   model.family = NULL   mre = NULL      # data pre-precessing ----      J <- dim(cumulative.payments.triangle)[2]   reduced.triangle <- c2t(t2c(cumulative.payments.triangle)[1:(J-leave.out),1:(J-leave.out)])   newt.rtt <- AggregateDataPP(reduced.triangle)      newt.apc <- apc.data.list(response=newt.rtt$incremental.payments.triangle,                             data.format=\"CL\")      ## stmomo -----   to.project <- t2c(cumulative.payments.triangle)[1:(J-leave.out-1),J-leave.out]   true.values <- t2c(cumulative.payments.triangle)[2:(J-leave.out),(J-leave.out+1):J]         for(ix in c('a','ac','ap','apc')){ ##names(models)          hz.fit <- StMoMo::fit(models[[ix]],                            Dxt = newt.rtt$occurrance,                            Ext = newt.rtt$exposure,                           wxt=newt.rtt$fit.w,                           iterMax=as.integer(1e+05))     hz.rate = fcst.fn(hz.fit,                    hazard.model = ix,                    gk.fc.model = 'a',                    ckj.fc.model= 'a')$rates[,1:leave.out]          J.new=dim(reduced.triangle)[2]     fij = (2+hz.rate)/(2-hz.rate)     pred.mx = fij     pred.mx[,1]=fij[,1]*c(NA,to.project)     temp=unname(pred.mx[1:(J.new-1),1][!is.na(pred.mx[1:(J.new-1),1])])     pred.mx[,2]=fij[,2]*c(rep(NA,J.new-length(temp)),temp)     true.mx= rbind(rep(NA,2),true.values)     # this is meant to be NA     true.mx[2,2]=NA        sq.errors = (pred.mx-true.mx)^2     abs.errors = abs(pred.mx-true.mx)     r.errors = (pred.mx-true.mx)/true.mx     error.inc.num = apply(pred.mx-true.mx,sum,MARGIN=2,na.rm=T)     error.inc.den = apply(true.mx,sum,MARGIN=2,na.rm=T)     model.name.ix = c(paste0(ix,\".val\"),paste0(ix,\".test\"))          model.name = c(model.name,model.name.ix)     model.family = c(model.family,rep(ix,2))     rmse = c(rmse,sqrt(apply(sq.errors,MARGIN = 2,mean,na.rm=T)))     mae = c(mae,apply(abs.errors,MARGIN = 2,mean,na.rm=T))     mre = c(mre,apply(r.errors,MARGIN = 2,mean,na.rm=T))     error.incidence = c(error.incidence,error.inc.num/error.inc.den)        }       ## stmomo results ----        out1 <- data.frame(     model.name,     model.family,     mre,     error.incidence,     rmse,     mae)      temp.ix <- grepl(\".val\", model.name)   temp.df <- out1[temp.ix,]      out2 <- data.frame(     rmse=temp.df$model.name[which(abs(temp.df$rmse)==min(abs(temp.df$rmse)))],     mre=temp.df$model.name[which(abs(temp.df$mre)==min(abs(temp.df$mre)))],     mae=temp.df$model.name[which(abs(temp.df$mae)==min(abs(temp.df$mae)))],     error.incidence=temp.df$model.name[which(abs(temp.df$error.incidence)==min(abs(temp.df$error.incidence)))])       temp.ix <- grepl(\".test\", model.name)   out3 <- out1[temp.ix,]      best.df = out2   best.df[1,]=NA      out.test.min <- data.frame(     rmse=out3$model.name[which(abs(out3$rmse)==min(abs(out3$rmse)))],     mre=out3$model.name[which(abs(out3$mre)==min(abs(out3$mre)))],     mae=out3$model.name[which(abs(out3$mae)==min(abs(out3$mae)))],     error.incidence=out3$model.name[which(abs(out3$error.incidence)==min(abs(out3$error.incidence)))])      temp.mx=matrix((sub(\"\\\\..*\", \"\", out2) == sub(\"\\\\..*\", \"\", out.test.min)),nrow=1)   choices.mx.clmplus=matrix(sub(\"\\\\..*\", \"\", out2),nrow=1)      agreement.frame.clmplus=data.frame(temp.mx)   choices.frame.clmplus=data.frame(choices.mx.clmplus)      colnames(agreement.frame.clmplus)=colnames(out2)   colnames(choices.frame.clmplus)=colnames(out2)      for(col.ix in colnames(out2)){      res=out1$model.family[out1$model.name == out2[1,col.ix]]   res.test = out3$model.family == res   best.df[1,col.ix] = out3[res.test,col.ix]}      families.set=c('a','apc') #'ap',   temp.ix = out3$model.family %in% families.set   comparison.df = out3[temp.ix,]   comparison.df = cbind(comparison.df,                         approach=rep('clmplus',length(families.set)))       ## apc ----      rmse = NULL   mae = NULL   error.pc = NULL   model.name = NULL   error.incidence = NULL   model.family = NULL   mre = NULL      true.inc.values <- t2c(cum2incr(cumulative.payments.triangle))[2:(J-leave.out),(J-leave.out+1):J]         for(apc.mods in c(\"AC\",\"APC\")){ #,\"AP\"          fit <- apc.fit.model(newt.apc,                          model.family = \"od.poisson.response\",                          model.design = apc.mods)          if(apc.mods == \"AC\"){fcst <- apc.forecast.ac(fit)$trap.response.forecast}     # if(apc.mods == \"AP\"){fcst <- apc.forecast.ap(fit)$trap.response.forecast}     if(apc.mods == \"APC\"){fcst <- apc.forecast.apc(fit)$trap.response.forecast}          plogram.hat = t2c.full.square(incr2cum(t(fcst)))     pred.mx = plogram.hat[,(J-leave.out+1):J]          # true.mx= rbind(rep(NA,2),true.inc.values)     # # this is meant to be NA     # true.mx[2,2]=NA        sq.errors = (pred.mx-true.mx)^2     abs.errors = abs(pred.mx-true.mx)     r.errors = (pred.mx-true.mx)/true.mx #use same benchmark     error.inc.num = apply(pred.mx-true.mx,sum,MARGIN=2,na.rm=T)     error.inc.den = apply(true.mx,sum,MARGIN=2,na.rm=T) #use same benchmark     model.name.ix = c(paste0(apc.mods,\".val\"),paste0(apc.mods,\".test\"))          model.name = c(model.name,tolower(model.name.ix))     model.family = c(model.family,tolower(rep(apc.mods,2)))     rmse = c(rmse,sqrt(apply(sq.errors,MARGIN = 2,mean,na.rm=T)))     mae = c(mae,apply(abs.errors,MARGIN = 2,mean,na.rm=T))     mre = c(mre,apply(r.errors,MARGIN = 2,mean,na.rm=T))     error.incidence = c(error.incidence,error.inc.num/error.inc.den)}                out4 <- data.frame(     model.name,     model.family,     mre,     error.incidence,     rmse,     mae)      temp.ix <- grepl(\".val\", model.name)   temp.df <- out4[temp.ix,]      out5 <- data.frame(     rmse=temp.df$model.name[which(abs(temp.df$rmse)==min(abs(temp.df$rmse)))],     mre=temp.df$model.name[which(abs(temp.df$mre)==min(abs(temp.df$mre)))],     mae=temp.df$model.name[which(abs(temp.df$mae)==min(abs(temp.df$mae)))],     error.incidence=temp.df$model.name[which(abs(temp.df$error.incidence)==min(abs(temp.df$error.incidence)))])      temp.ix <- grepl(\".test\", model.name)   out6 <- out4[temp.ix,]      out.test.min2 <- data.frame(   rmse=out6$model.name[which(abs(out6$rmse)==min(abs(out6$rmse)))],   mre=out6$model.name[which(abs(out6$mre)==min(abs(out6$mre)))],   mae=out6$model.name[which(abs(out6$mae)==min(abs(out6$mae)))],   error.incidence=out6$model.name[which(abs(out6$error.incidence)==min(abs(out6$error.incidence)))])    temp.mx=matrix((sub(\"\\\\..*\", \"\", out5) == sub(\"\\\\..*\", \"\", out.test.min2)),nrow=1)   choices.mx.apc=matrix(sub(\"\\\\..*\", \"\", out5),nrow=1)      choices.frame.apc=data.frame(choices.mx.apc)   agreement.frame.apc=data.frame(temp.mx)      colnames(agreement.frame.apc)=colnames(out5)   colnames(choices.frame.apc)=colnames(out5)      best.df.apc = out5   best.df.apc[1,]=NA      for(col.ix in colnames(out5)){      res=out4$model.family[out4$model.name == out5[1,col.ix]]   res.test = out6$model.family == res   best.df.apc[1,col.ix] = out6[res.test,col.ix]}          families.set=c('ac','apc') #'ap',   temp.ix = out6$model.family %in% families.set   comparison.df.apc = out6[temp.ix,]   comparison.df.apc = cbind(comparison.df.apc,                             approach=rep('apc',length(families.set)))         out = list(     best.model.clmplus = best.df,     best.model.apc = best.df.apc,     agreement.frame.clmplus=agreement.frame.clmplus,     agreement.frame.apc=agreement.frame.apc,     choices.frame.clmplus=choices.frame.clmplus,     choices.frame.apc=choices.frame.apc,     comparison.df = rbind(comparison.df,                           comparison.df.apc))      return(out)} modelcomparison<-function(list.of.datasets){   \"This functions returns the datasets to plot the bake-off section of the paper.      The input is a list of datasets that constitue the sample.       The output is datasets that contain accuracy measures.      \"   best.fit=NULL   families.fit=NULL   agreement.clmplus=NULL   agreement.apc=NULL   choices.clmplus=NULL   choices.apc=NULL      for(df.ix in names(list.of.datasets)){     cat(paste0(\".. Comparison on dataset: \",df.ix))     out.ix = modelcomparison.1d(list.of.datasets[[df.ix]])          best.of.the.bests.df=best.of.the.bests(out.ix$best.model.clmplus,                                         out.ix$best.model.apc)          out.ix$best.model.clmplus['package']= 'clmplus'     out.ix$best.model.apc['package']= 'apc'     best.of.the.bests.df['package']='overall.best'          best.fit=rbind(best.fit,                    out.ix$best.model.clmplus,                    out.ix$best.model.apc,                    best.of.the.bests.df)          families.fit=rbind(families.fit,                    out.ix$comparison.df)          agreement.clmplus=rbind(agreement.clmplus,                          out.ix$agreement.frame.clmplus)          agreement.apc=rbind(agreement.apc,                          out.ix$agreement.frame.apc)          choices.clmplus=rbind(choices.clmplus,                          out.ix$choices.frame.clmplus)          choices.apc=rbind(choices.apc,                          out.ix$choices.frame.apc)   }      best.fit[,1:4]=apply(best.fit[,1:4],MARGIN = 2,FUN = as.numeric)      families.fit[,c('mre',                   'error.incidence',                   'rmse',                   'mae')]=apply(                     families.fit[,c('mre',                                     'error.incidence',                                     'rmse',                                     'mae')],                     MARGIN = 2,                     FUN = as.numeric)         out = list(best.fit=best.fit,              families.fit=families.fit,              agreement.clmplus=agreement.clmplus,              agreement.apc=agreement.apc,              choices.clmplus=choices.clmplus,              choices.apc=choices.apc)      return(out)    } bake.off <- function(models.comparison){   \"   This function plots out the results from the previous computations.       It takes as input the resulting dataframes of model.comparison.      The output is the boxplots of the paper's bake-off section.       \"      p1<- models.comparison$best.fit[,c(\"rmse\",\"mae\",\"package\")] %>%     tidyr::pivot_longer(-c(package)) %>%     ggplot(aes(x=package,y=value))+     geom_boxplot()+     facet_wrap(.~name,nrow = 1,strip.position = 'bottom')+     theme_bw()+     theme(strip.placement = 'outside',strip.background = element_blank())      p2<- models.comparison$best.fit[,c(\"mre\",\"error.incidence\",\"package\")] %>%     tidyr::pivot_longer(-c(package)) %>%     ggplot(aes(x=package,y=value))+     geom_boxplot()+     facet_wrap(.~name,nrow = 1,strip.position = 'bottom')+     theme_bw()+     theme(strip.placement = 'outside',strip.background = element_blank())      abs.best=models.comparison$best.fit[,c(\"mre\",\"error.incidence\",\"package\")]   abs.best[,c(\"mre\",\"error.incidence\")]=apply(abs.best[,c(\"mre\",\"error.incidence\")],                                               MARGIN=2,                                               FUN=abs)   p3<- abs.best %>%     tidyr::pivot_longer(-c(package)) %>%     ggplot(aes(x=package,y=value))+     geom_boxplot()+     facet_wrap(.~name,nrow = 1,strip.position = 'bottom')+     theme_bw()+     theme(strip.placement = 'outside',strip.background = element_blank())      only.ei=models.comparison$best.fit[,c(\"error.incidence\",\"package\")]   only.ei[,c(\"error.incidence\")]=abs(only.ei[,c(\"error.incidence\")])      p4<- abs.best %>%   tidyr::pivot_longer(-c(package)) %>%   ggplot(aes(x=package,y=value))+   geom_boxplot()+   # facet_wrap(.~name,nrow = 1,strip.position = 'bottom')+   theme_bw()+   theme(strip.placement = 'outside',strip.background = element_blank())         out = list(p1=p1,              p2=p2,              p3=p3,              p4=p4)      return(out) } out=modelcomparison(list.of.datasets = list.of.datasets) #> .. Comparison on dataset: GenIns #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: sifa.mod #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: sifa.gtpl #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: sifa.mtpl #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> Warning in dpois(y, mu, log = TRUE): non-integer x = 860.063891 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49353.589600 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 29251.193380 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 36106.295210 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 40125.390780 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 44498.942240 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 45490.189570 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 48040.321560 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49991.357650 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49694.294990 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 20880.666980 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12463.983790 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 13441.333110 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12951.176400 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15370.423630 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15339.426370 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 17842.901760 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 19570.203660 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 10047.067150 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5144.085289 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5868.234632 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 6033.755464 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5593.853546 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5478.076757 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 7035.199194 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3933.606063 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2726.947823 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2881.972323 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3009.655856 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2615.516340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2540.639658 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2906.368627 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2359.362462 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2421.987896 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1264.396267 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1984.311792 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2136.804699 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1333.856105 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 918.004039 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1249.952517 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1134.706143 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1238.429974 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1075.978340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 733.741025 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 941.440475 #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> Warning in dpois(y, mu, log = TRUE): non-integer x = 860.063891 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49353.589600 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 29251.193380 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 36106.295210 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 40125.390780 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 44498.942240 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 45490.189570 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 48040.321560 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49991.357650 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49694.294990 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 20880.666980 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12463.983790 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 13441.333110 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12951.176400 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15370.423630 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15339.426370 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 17842.901760 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 19570.203660 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 10047.067150 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5144.085289 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5868.234632 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 6033.755464 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5593.853546 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5478.076757 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 7035.199194 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3933.606063 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2726.947823 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2881.972323 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3009.655856 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2615.516340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2540.639658 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2906.368627 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2359.362462 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2421.987896 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1264.396267 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1984.311792 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2136.804699 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1333.856105 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 918.004039 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1249.952517 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1134.706143 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1238.429974 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1075.978340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 733.741025 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 941.440475 #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> Warning in dpois(y, mu, log = TRUE): non-integer x = 860.063891 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49353.589600 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 29251.193380 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 36106.295210 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 40125.390780 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 44498.942240 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 45490.189570 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 48040.321560 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49991.357650 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49694.294990 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 20880.666980 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12463.983790 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 13441.333110 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12951.176400 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15370.423630 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15339.426370 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 17842.901760 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 19570.203660 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 10047.067150 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5144.085289 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5868.234632 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 6033.755464 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5593.853546 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5478.076757 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 7035.199194 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3933.606063 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2726.947823 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2881.972323 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3009.655856 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2615.516340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2540.639658 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2906.368627 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2359.362462 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2421.987896 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1264.396267 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1984.311792 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2136.804699 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1333.856105 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 918.004039 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1249.952517 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1134.706143 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1238.429974 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1075.978340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 733.741025 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 941.440475 #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> Warning in dpois(y, mu, log = TRUE): non-integer x = 860.063891 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49353.589600 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 29251.193380 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 36106.295210 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 40125.390780 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 44498.942240 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 45490.189570 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 48040.321560 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49991.357650 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49694.294990 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 20880.666980 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12463.983790 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 13441.333110 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12951.176400 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15370.423630 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15339.426370 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 17842.901760 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 19570.203660 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 10047.067150 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5144.085289 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5868.234632 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 6033.755464 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5593.853546 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5478.076757 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 7035.199194 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3933.606063 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2726.947823 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2881.972323 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3009.655856 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2615.516340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2540.639658 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2906.368627 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2359.362462 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2421.987896 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1264.396267 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1984.311792 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2136.804699 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1333.856105 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 918.004039 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1249.952517 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1134.706143 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1238.429974 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1075.978340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 733.741025 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 941.440475 #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: amases.gtpl #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: amases.mod #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: amases.mtpl #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: bz #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: ta #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: xl #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 153 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -17 -16 -15 -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 17  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 153 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -17 -16 -15 -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 17  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 153 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -17 -16 -15 -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 17  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 153 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -17 -16 -15 -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 17  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: vnj #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: abc #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: autoC #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: autoP #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: autoBI #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: mclpaid #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 10 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -4 -3 -2 -1 4  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 10 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -4 -3 -2 -1 4  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 10 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -4 -3 -2 -1 4  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 10 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -4 -3 -2 -1 4  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: medmal #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: mortgage #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: mw08 #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: mw14 #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 105 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 14  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 105 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 14  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 105 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 14  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 105 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 14  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: ukmotor #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 10 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -4 -3 -2 -1 4  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 10 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -4 -3 -2 -1 4  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 10 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -4 -3 -2 -1 4  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 10 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -4 -3 -2 -1 4  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> .. Comparison on dataset: usapaid #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm  cake = bake.off(out) cake$p3 abs.best=out$best.fit[,c(\"error.incidence\",\"package\")] abs.best[,c(\"error.incidence\")]=abs(abs.best[,c(\"error.incidence\")]) abs.best[,'data.source']=sort(rep(seq(1,dim(abs.best)[1]/3),3))   p3<- ggplot(abs.best,aes(x=package,                          y=error.incidence,                          fill=package,                          label=data.source)) +   geom_boxplot(outlier.shape = NA)+   viridis::scale_fill_viridis(discrete=T, alpha=0.6) +   geom_jitter(color=\"black\",                size=1,                alpha=0.9,                position = position_jitter(seed = 1)) +   geom_text(aes(label=ifelse(data.source%in% c(15,24,17,18),                    as.character(data.source),'')),   hjust=0,   vjust=0,   size=5,   position = position_jitter(seed = 1))+   # geom_text(position = position_jitter(seed = 42))+   coord_flip()+   theme_bw()+   ggplot2::labs(x=\"Package\", y=\"Error Incidence\")+   theme(axis.text.y = element_text(size=15),         axis.text.x  = element_text(size=15))+   theme(axis.title.y = element_text(size=20),          axis.title.x  = element_text(size=20))  p3"},{"path":"https://gpitt71.github.io/clmplus/articles/modelscomparison.html","id":"rankings","dir":"Articles","previous_headings":"","what":"Rankings","title":"Models comparison","text":"Within section provide practitioners code perform models ranking. Now different training validation split. training validation split use represented following picture.  following picture models ranks plot included paper.  can useful inspect average rank different models comparing. following picture included paper shows models ranks counts. provides additional consistency results included work.","code":"# models ranking  J=12 df<-data.frame(expand.grid(c(0:(J-1)),c(0:(J-1))),c(1:(J^2))) colnames(df) <- c(\"origin\",\"dev\",\"value\") df$value[df$origin+df$dev==(J-1)]=c(2) df$value[df$origin+df$dev<(J-1)]=c(1) df$value[df$origin+df$dev>=J]=c(NA) df[J,3]=c(NA) df[J*J-J+1,3]=c(NA)  ggplot(data=df, aes(x=as.integer(dev), y=as.integer(origin))) +    geom_tile(aes(fill = as.factor(value),color=\"#000000\"))+scale_y_reverse()+   scale_fill_manual(values=c(\"royalblue\", \"darkred\", \"white\"),                     na.value = \"white\",                     labels=c(\"Train\",\"Validation\",\"\"))+   theme_classic()+   labs(x=\"Development year\", y=\"Accident year\",fill=\"\")+   theme(axis.title.x = element_text(size=8), axis.text.x  = element_text(size=7))+   theme(axis.title.y = element_text(size=8), axis.text.y  = element_text(size=7))+   scale_color_brewer(guide = 'none') modelsranking.1d <- function(data.T){   \"   Function to rank the clmplus package and apc package age-period-cohort models.      This function takes a triangle of cumulative payments as input.      It returns the ranking on the triangle.   \"         leave.out=1         model.name = NULL   error.incidence = NULL   mre = NULL      #pre-processing   triangle <- data.T$cumulative.payments.triangle   J <- dim(triangle)[2]   reduced.triangle <- c2t(t2c(triangle)[1:(J-leave.out),1:(J-leave.out)])   newt.rtt <- AggregateDataPP(reduced.triangle)   to.project <- t2c(triangle)[1:(J-leave.out-1),J-leave.out]   true.values <- t2c(triangle)[2:(J-leave.out),J]         for(ix in c('a','ac','ap','apc')){          hz.fit <- StMoMo::fit(models[[ix]],                            Dxt = newt.rtt$occurrance,                            Ext = newt.rtt$exposure,                           wxt=newt.rtt$fit.w,                           iterMax=as.integer(1e+05))     hz.rate = fcst.fn(hz.fit,                    hazard.model = ix,                    gk.fc.model = 'a',                    ckj.fc.model= 'a')$rates[,1]          fij = (2+hz.rate)/(2-hz.rate)     pred.fij = fij[(leave.out+1):length(fij)]     pred.v=to.project*pred.fij          r.errors = (pred.v-true.values)/true.values     error.inc.num = sum(pred.v-true.values,na.rm = T)     error.inc.den = sum(true.values)          model.name = c(model.name,                    paste0('clmplus.',ix))     error.incidence = c(error.incidence,error.inc.num/error.inc.den)     mre = c(mre,mean(r.errors))             }      # ix='lc'   # hz.fit <- fit.lc.nr(data.T = newt.rtt,   #                     iter.max = 3e+04)   # if(hz.fit$converged==TRUE){hz.rate = forecast.lc.nr(hz.fit,J=dim(newt.rtt$cumulative.payments.triangle)[2])$rates[,1:leave.out]   # fij = (2+hz.rate)/(2-hz.rate)   # pred.fij = fij[(leave.out+1):length(fij)]   # pred.v=to.project*pred.fij   # r.errors = (pred.v-true.values)/true.values   #    # error.inc.num = sum(pred.v-true.values,na.rm = T)   # error.inc.den = sum(true.values)   #    # model.name = c(model.name,   #                paste0('clmplus.',ix))   # error.incidence = c(error.incidence,error.inc.num/error.inc.den)   # mre = c(mre,mean(r.errors))}      out1 <- data.frame(     model.name,     # mre,     error.incidence)      ## APC package      newt.apc <- apc.data.list(response=newt.rtt$incremental.payments.triangle,                             data.format=\"CL\")      ## apc      rmse = NULL   mae = NULL   error.pc = NULL   model.name = NULL   error.incidence = NULL   model.family = NULL   mre = NULL      true.inc.values <- t2c(data.T$incremental.payments.triangle)[2:(J-leave.out),(J-leave.out+1):J]         for(apc.mods in c(\"AC\",\"APC\")){ #,\"AP\"          fit <- apc.fit.model(newt.apc,                          model.family = \"od.poisson.response\",                          model.design = apc.mods)          if(apc.mods == \"AC\"){fcst <- apc.forecast.ac(fit)$trap.response.forecast}     # if(apc.mods == \"AP\"){fcst <- apc.forecast.ap(fit)$trap.response.forecast}     if(apc.mods == \"APC\"){fcst <- apc.forecast.apc(fit)$trap.response.forecast}          plogram.hat = t2c.full.square(incr2cum(t(fcst)))     pred.v = plogram.hat[,(J-leave.out+1):J]     pred.v = pred.v[2:length(pred.v)]               r.errors = (pred.v-true.values)/true.values     error.inc.num = sum(pred.v-true.values)     error.inc.den = sum(true.values)          model.name = c(model.name,                    paste0('apc.',tolower(apc.mods)))     error.incidence = c(error.incidence,error.inc.num/error.inc.den)     mre = c(mre,mean(r.errors))        }      out2 <- data.frame(     model.name,     # mre,     error.incidence)      out3 <- rbind(out1,out2)      out3 <- out3[order(abs(out3$error.incidence),decreasing = F),]   out3[,'ei.rank']=c(1:dim(out3)[1])   # out3[,'mre.rank']=order(abs(out3$mre),decreasing = F)   #fix it manually   r2set=min(out3$ei.rank[out3$model.name=='apc.ac'],             out3$ei.rank[out3$model.name=='clmplus.a'])      out3$ei.rank[out3$model.name=='apc.ac']=r2set   out3$ei.rank[out3$model.name=='clmplus.a']=r2set      if( out3$ei.rank[out3$model.name=='apc.ac'] < max(out3$ei.rank)){     cond=out3$ei.rank>out3$ei.rank[out3$model.name=='apc.ac']     out3$ei.rank[cond]=out3$ei.rank[cond]-1   }      return(list(models.ranks=out3))    } modelsranking <- function(list.of.datasets){      \"   This functions returns the datasets to plot in the ranking section of the paper.      The input is a list of datasets that constitue the sample.       The output is the rankings across different data sources.   \"         full.ranks=NULL      for(df.ix in names(list.of.datasets)){          out.df=modelsranking.1d(AggregateDataPP(list.of.datasets[[df.ix]]))     out.df$models.ranks[,'data.source']=rep(df.ix,dim(out.df$models.ranks)[1])     full.ranks=rbind(full.ranks,out.df$models.ranks)     }      return(list(full.ranks=full.ranks)) } full.ranks=modelsranking(list.of.datasets) #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> Warning in dpois(y, mu, log = TRUE): non-integer x = 860.063891 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 458.156066 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 281.869679 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49353.589600 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 50605.820000 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 29251.193380 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 36106.295210 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 40125.390780 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 44498.942240 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 45490.189570 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 48040.321560 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49991.357650 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49694.294990 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 20880.666980 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 18304.246140 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12463.983790 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 13441.333110 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12951.176400 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15370.423630 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15339.426370 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 17842.901760 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 19570.203660 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 10047.067150 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 8201.559214 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5144.085289 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5868.234632 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 6033.755464 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5593.853546 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5478.076757 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 7035.199194 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3933.606063 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5749.890057 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2726.947823 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2881.972323 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3009.655856 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2615.516340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2540.639658 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2906.368627 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2725.682936 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2359.362462 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2421.987896 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1264.396267 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1984.311792 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2136.804699 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1294.338023 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1333.856105 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 918.004039 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1249.952517 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1134.706143 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1184.355428 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1238.429974 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1075.978340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 733.741025 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 904.371165 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 941.440475 #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> Warning in dpois(y, mu, log = TRUE): non-integer x = 860.063891 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 458.156066 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 281.869679 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49353.589600 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 50605.820000 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 29251.193380 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 36106.295210 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 40125.390780 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 44498.942240 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 45490.189570 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 48040.321560 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49991.357650 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49694.294990 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 20880.666980 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 18304.246140 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12463.983790 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 13441.333110 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12951.176400 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15370.423630 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15339.426370 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 17842.901760 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 19570.203660 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 10047.067150 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 8201.559214 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5144.085289 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5868.234632 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 6033.755464 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5593.853546 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5478.076757 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 7035.199194 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3933.606063 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5749.890057 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2726.947823 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2881.972323 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3009.655856 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2615.516340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2540.639658 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2906.368627 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2725.682936 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2359.362462 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2421.987896 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1264.396267 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1984.311792 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2136.804699 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1294.338023 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1333.856105 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 918.004039 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1249.952517 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1134.706143 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1184.355428 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1238.429974 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1075.978340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 733.741025 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 904.371165 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 941.440475 #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> Warning in dpois(y, mu, log = TRUE): non-integer x = 860.063891 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 458.156066 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 281.869679 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49353.589600 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 50605.820000 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 29251.193380 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 36106.295210 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 40125.390780 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 44498.942240 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 45490.189570 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 48040.321560 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49991.357650 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49694.294990 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 20880.666980 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 18304.246140 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12463.983790 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 13441.333110 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12951.176400 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15370.423630 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15339.426370 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 17842.901760 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 19570.203660 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 10047.067150 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 8201.559214 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5144.085289 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5868.234632 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 6033.755464 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5593.853546 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5478.076757 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 7035.199194 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3933.606063 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5749.890057 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2726.947823 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2881.972323 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3009.655856 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2615.516340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2540.639658 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2906.368627 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2725.682936 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2359.362462 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2421.987896 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1264.396267 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1984.311792 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2136.804699 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1294.338023 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1333.856105 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 918.004039 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1249.952517 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1134.706143 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1184.355428 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1238.429974 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1075.978340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 733.741025 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 904.371165 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 941.440475 #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> Warning in dpois(y, mu, log = TRUE): non-integer x = 860.063891 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 458.156066 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 281.869679 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49353.589600 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 50605.820000 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 29251.193380 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 36106.295210 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 40125.390780 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 44498.942240 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 45490.189570 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 48040.321560 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49991.357650 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 49694.294990 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 20880.666980 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 18304.246140 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12463.983790 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 13441.333110 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 12951.176400 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15370.423630 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 15339.426370 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 17842.901760 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 19570.203660 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 10047.067150 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 8201.559214 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5144.085289 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5868.234632 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 6033.755464 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5593.853546 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5478.076757 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 7035.199194 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3933.606063 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 5749.890057 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2726.947823 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2881.972323 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 3009.655856 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2615.516340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2540.639658 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2906.368627 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2725.682936 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2359.362462 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2421.987896 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1264.396267 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1984.311792 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 2136.804699 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1294.338023 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1333.856105 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 918.004039 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1249.952517 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1134.706143 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1184.355428 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1238.429974 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 1075.978340 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 733.741025 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 904.371165 #> Warning in dpois(y, mu, log = TRUE): non-integer x = 941.440475 #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 55 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 10  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 171 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -18 -17 -16 -15 -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 18  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 171 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -18 -17 -16 -15 -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 18  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 171 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -18 -17 -16 -15 -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 18  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 171 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -18 -17 -16 -15 -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 18  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 45 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -9 -8 -7 -6 -5 -4 -3 -2 -1 9  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 21 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -6 -5 -4 -3 -2 -1 6  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 28 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -7 -6 -5 -4 -3 -2 -1 7  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 120 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -15 -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 15  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 120 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -15 -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 15  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 120 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -15 -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 15  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 120 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -15 -14 -13 -12 -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 15  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 15 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -5 -4 -3 -2 -1 5  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm #> Warning in fit.StMoMo(models[[ix]], Dxt = newt.rtt$occurrance, Ext = newt.rtt$exposure, : StMoMo: 36 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -8 -7 -6 -5 -4 -3 -2 -1 8  #> StMoMo: Start fitting with gnm #> StMoMo: Finish fitting with gnm p_min_expd0 <- ggplot(full.ranks$full.ranks, aes(model.name, data.source)) +    geom_tile(aes(fill = cut(ei.rank, breaks=0:6, labels=1:6)), colour = \"grey\") +    ggtitle(\" \") +   theme_classic()+   geom_text(aes(label = ei.rank))+    scale_y_discrete(limits=names(list.of.datasets)) +    scale_fill_manual(drop=FALSE, values=colorRampPalette(c(\"white\",\"#6699CC\"))(6), na.value=\"#EEEEEE\", name=\"Rank\") +     xlab(\"Model\") + ylab(\"Data source\") p_min_expd0 tbl=full.ranks$full.ranks %>%   dplyr::group_by(model.name) %>%   dplyr::summarise(mean.rank = mean(ei.rank)) tbl #> # A tibble: 6 × 2 #>   model.name  mean.rank #>   <chr>           <dbl> #> 1 apc.ac           3.09 #> 2 apc.apc          4.14 #> 3 clmplus.a        3.09 #> 4 clmplus.ac       2.32 #> 5 clmplus.ap       3    #> 6 clmplus.apc      2.45 library(dplyr) temp.df=full.ranks$full.ranks[,c('model.name','ei.rank')] %>%   group_by(model.name, ei.rank) %>% summarise(count = n()) #> `summarise()` has grouped output by 'model.name'. You can override using the #> `.groups` argument. ggplot(temp.df, aes(y=count, x=factor(ei.rank))) +      geom_bar(position=\"stack\", stat=\"identity\",fill='#6699CC') +   scale_y_continuous(limits=c(0,15))+   facet_wrap(~model.name, scales='free')+   theme_classic()+   ylab(\"\")+   xlab(\"Rank\")"},{"path":"https://gpitt71.github.io/clmplus/articles/modelscomparison.html","id":"conclusions","dir":"Articles","previous_headings":"","what":"Conclusions","title":"Models comparison","text":"vignette wanted show tool-box actuarial scientists enriched thanks clmplus. important perform different analysis validate results. work showed two. best model absolute terms: purpose show options can improve claims reserving.","code":""},{"path":"https://gpitt71.github.io/clmplus/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Gabriele Pittarello. Author, maintainer, copyright holder. Munir Hiabu. Author, copyright holder. Andres Villegas. Author, copyright holder.","code":""},{"path":"https://gpitt71.github.io/clmplus/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pittarello G, Hiabu M, Villegas (2024). clmplus: Tool-Box Chain Ladder Plus Models. R package version 1.0.0, https://gpitt71.github.io/clmplus/, https://github.com/gpitt71/clmplus.","code":"@Manual{,   title = {clmplus: Tool-Box of Chain Ladder Plus Models},   author = {Gabriele Pittarello and Munir Hiabu and Andres Villegas},   year = {2024},   note = {R package version 1.0.0,     https://gpitt71.github.io/clmplus/},   url = {https://github.com/gpitt71/clmplus}, }"},{"path":"https://gpitt71.github.io/clmplus/index.html","id":"clmplus","dir":"","previous_headings":"","what":"Tool-Box of Chain Ladder Plus Models","title":"Tool-Box of Chain Ladder Plus Models","text":"clmplus R package implementing age-period-cohort models claim development presented manuscript ‘Replicating extending chain-ladder via age-period-cohort structure claim development run-triangle’ doi:10.48550/arXiv.2301.03858.","code":""},{"path":"https://gpitt71.github.io/clmplus/index.html","id":"our-models","dir":"","previous_headings":"","what":"Our models","title":"Tool-Box of Chain Ladder Plus Models","text":"clmplus relies powerful StMoMo package. Users can either rely default models set configuration claim development.","code":""},{"path":"https://gpitt71.github.io/clmplus/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Tool-Box of Chain Ladder Plus Models","text":"developer version clmplus can installed GitHub. current version clmplus can installed CRAN.","code":"library(devtools) devtools::install_github(\"gpitt71/clmplus\") install.packages('clmplus')"},{"path":"https://gpitt71.github.io/clmplus/index.html","id":"get-started","dir":"","previous_headings":"","what":"Get Started","title":"Tool-Box of Chain Ladder Plus Models","text":"brief example, work sifa.mtpl data clmplus package. examples can found package vignettes. data set cumulative claim payments transformed AggregateDataPP object pre-processes data claim development modelling. models can fit clmplus function. plot function can used explore scaled deviance residuals fitted models. , example age-period-cohort (apc) model claim development. Predictions performed predict function. fitted effect (extrapolated) effects can inspected plot function. continue example apc model.","code":"library(clmplus)  data (\"sifa.mtpl\") dataset = sifa.mtpl datapp = AggregateDataPP(cumulative.payments.triangle = dataset, eta= 1/2) a.model.fit=clmplus(datapp,                  hazard.model = \"a\") # age-model replicates the chain ladder  ac.model.fit=clmplus(datapp,                  hazard.model = \"ac\")  ap.model.fit=clmplus(datapp,                  hazard.model = \"ap\")  apc.model.fit=clmplus(datapp,                   hazard.model = \"apc\") plot(apc.model.fit) a.model=predict(a.model.fit)  # clmplus reserve (age model) sum(a.model$reserve) #226875.5   ac.model=predict(ac.model.fit,                  gk.fc.model = 'a',                  gk.order = c(1,1,0))  # clmplus reserve (age-cohort model) sum(ac.model$reserve) #205305.7  ap.model= predict(ap.model.fit,                  ckj.fc.model = 'a',                  ckj.order = c(0,1,0))  # clmplus reserve (age-period model) sum(ap.model$reserve) #215602.8   apc.model= predict(apc.model.fit,                   gk.fc.model = 'a',                   ckj.fc.model = 'a',                   gk.order = c(1,1,0),                   ckj.order = c(0,1,0)) # clmplus reserve (age-period-cohort model) sum(apc.model$reserve) #213821.6 plot(apc.model)"},{"path":"https://gpitt71.github.io/clmplus/reference/AggregateDataPP.html","id":null,"dir":"Reference","previous_headings":"","what":"Pre-process Run-Off Triangles — AggregateDataPP","title":"Pre-process Run-Off Triangles — AggregateDataPP","text":"Pre-process Run-Triangles.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/AggregateDataPP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pre-process Run-Off Triangles — AggregateDataPP","text":"","code":"AggregateDataPP(   cumulative.payments.triangle,   entries.weights = NULL,   eta = 1/2 )"},{"path":"https://gpitt71.github.io/clmplus/reference/AggregateDataPP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pre-process Run-Off Triangles — AggregateDataPP","text":"cumulative.payments.triangle triangle matrix matrix array object, input triangle cumulative payments. entries.weights triangle matrix matrix array model entries weights. eta numeric, individual claims exposure cell, also known lost exposure. must interval (0,1].","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/AggregateDataPP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pre-process Run-Off Triangles — AggregateDataPP","text":"object class AggregateDataPP. Lists following elements: cumulative.payments.triangle triangle matrix object, input triangle cumulative payments. occurrance matrix array object, occurrence derived input triangle. exposure matrix array object, exposure derived input triangle, eta claims arrival assumption. incremental.payments.triangle triangle matrix object, incremental payments derived input. fit.w matrix array object, weights used estimation. J integer, Run-triangle dimension. diagonal numeric, cumulative payments last diagonal. eta numeric, Expected time--event cell. .e., lost exposure.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/AggregateDataPP.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Pre-process Run-Off Triangles — AggregateDataPP","text":"Pittarello, G., Hiabu, M., & Villegas, . M. (2023). Replicating extending chain-ladder via age-period-cohort structure claim development run-triangle. arXiv preprint arXiv:2301.03858.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/AggregateDataPP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Pre-process Run-Off Triangles — AggregateDataPP","text":"","code":"data(sifa.mtpl) sifa.mtpl.rtt <- AggregateDataPP(cumulative.payments.triangle=sifa.mtpl)"},{"path":"https://gpitt71.github.io/clmplus/reference/amases.gtpl.html","id":null,"dir":"Reference","previous_headings":"","what":"Amases GTPL — amases.gtpl","title":"Amases GTPL — amases.gtpl","text":"Dataset cumulative paid claims small italian company line business: general third party liability.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/amases.gtpl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Amases GTPL — amases.gtpl","text":"","code":"amases.gtpl"},{"path":"https://gpitt71.github.io/clmplus/reference/amases.gtpl.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Amases GTPL — amases.gtpl","text":"Run-triangle 12 development periods.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/amases.gtpl.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Amases GTPL — amases.gtpl","text":"Savelli, Nino,  Clemente, Gian Paolo. \"Lezioni di matematica attuariale delle assicurazioni danni.\" EDUCatt-Ente per il diritto allo studio universitario dell'Università Cattolica, 2014","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/amases.mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Amases MOD — amases.mod","title":"Amases MOD — amases.mod","text":"Dataset cumulative paid claims small italian company line business: motor damage.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/amases.mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Amases MOD — amases.mod","text":"","code":"amases.mod"},{"path":"https://gpitt71.github.io/clmplus/reference/amases.mod.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Amases MOD — amases.mod","text":"Run-triangle 12 development periods.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/amases.mod.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Amases MOD — amases.mod","text":"Savelli, Nino, Clemente, Gian Paolo. \"Lezioni di matematica attuariale delle assicurazioni danni.\" EDUCatt-Ente per il diritto allo studio universitario dell'Università Cattolica, 2014","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/amases.mtpl.html","id":null,"dir":"Reference","previous_headings":"","what":"Amases MTPL — amases.mtpl","title":"Amases MTPL — amases.mtpl","text":"Dataset cumulative paid claims small italian company line business: motor third party liability.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/amases.mtpl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Amases MTPL — amases.mtpl","text":"","code":"amases.mtpl"},{"path":"https://gpitt71.github.io/clmplus/reference/amases.mtpl.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Amases MTPL — amases.mtpl","text":"Run-triangle 12 development periods.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/amases.mtpl.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Amases MTPL — amases.mtpl","text":"Savelli, Nino, Clemente, Gian Paolo. \"Lezioni di matematica attuariale delle assicurazioni danni.\" EDUCatt-Ente per il diritto allo studio universitario dell'Università Cattolica, 2014","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.AggregateDataPP.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit Chain Ladder Plus to reverse time triangles. — clmplus.AggregateDataPP","title":"Fit Chain Ladder Plus to reverse time triangles. — clmplus.AggregateDataPP","text":"Method fit Chain Ladder plus models AggregateDataPP objects.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.AggregateDataPP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit Chain Ladder Plus to reverse time triangles. — clmplus.AggregateDataPP","text":"","code":"# S3 method for class 'AggregateDataPP' clmplus(   AggregateDataPP,   hazard.model = NULL,   link = c(\"log\", \"logit\"),   staticAgeFun = TRUE,   periodAgeFun = \"NP\",   cohortAgeFun = NULL,   effect_log_scale = TRUE,   constFun = function(ax, bx, kt, b0x, gc, wxt, ages) list(ax = ax, bx = bx, kt = kt, b0x     = b0x, gc = gc),   ... )"},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.AggregateDataPP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit Chain Ladder Plus to reverse time triangles. — clmplus.AggregateDataPP","text":"AggregateDataPP AggregateDataPP object, reverse time triangle fitted. hazard.model character, hazard model supported package. model can chosen : '': Age model, equivalent Mack chain-ladder. 'ac': Age cohort effects. 'ap': Age cohort effects. 'apc': Age cohort period effects. link character, defines link function random component associated mortality model. \"log\" assume deaths follow Poisson distribution use log link \"logit\" assume deaths follow Binomial distribution logit link. disregarded unless practitioner specifies hazard model StMoMo. staticAgeFun logical, indicates static age function \\(\\alpha_x\\) included. disregarded unless practitioner specifies hazard model StMoMo. periodAgeFun list, list length \\(N\\) definitions period age modulating parameters \\(\\beta_x^{()}\\). entry can take values: \"NP\" non-parametric age terms, \"1\" \\(\\beta_x^{()}=1\\) predefined parametric function age (see details). Set NULL period terms model. disregarded unless practitioner specifies hazard model StMoMo. cohortAgeFun character function, defines cohort age modulating parameter \\(\\beta_x^{(0)}\\). can take values: \"NP\" non-parametric age terms, \"1\" \\(\\beta_x^{(0)}=1\\), predefined parametric function age (see details) NULL cohort effect. disregarded unless practitioner specifies hazard model StMoMo. effect_log_scale logical, whether effects logarithmic scale. default, TRUE. constFun function, defines identifiability constraints model. must function form constFun <- function(ax, bx, kt, b0x, gc, wxt, ages) taking set fitted model parameters returning list list(ax = ax, bx = bx, kt = kt, b0x = b0x, gc = gc) model parameters identifiability constraints applied. omitted identifiability constraints applied model. disregarded unless practitioner specifies hazard model StMoMo. ... parameters passed clmplus.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.AggregateDataPP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit Chain Ladder Plus to reverse time triangles. — clmplus.AggregateDataPP","text":"object class clmplusmodel. list following elements: model.fit fitStMoMo object, specified hazard model fit StMoMo. apc_input list object. list containing following model inputs age-period-cohort notation: J (integer) Run-triangle dimension.  eta (numeric) Expected time--event cell. .e., lost exposure.   diagonal (numeric) Cumulative payments last diagonal. hazard.model (character), hazard model specified user. Set user.specific custom model passed. hazard_scaled_deviance_residuals matrix array Triangle scaled deviance residuals. fitted_development_factors matrix array Triangle fitted development factors. fitted_effects list List development-accident-calendar effects fitted.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.AggregateDataPP.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fit Chain Ladder Plus to reverse time triangles. — clmplus.AggregateDataPP","text":"Pittarello, Gabriele, Munir Hiabu, Andrés M. Villegas. \"Replicating extending chain ladder via age-period-cohort structure claim development run-triangle.\" arXiv preprint arXiv:2301.03858 (2023).","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.AggregateDataPP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit Chain Ladder Plus to reverse time triangles. — clmplus.AggregateDataPP","text":"","code":"data(sifa.mtpl) sifa.mtpl.rtt <- AggregateDataPP(cumulative.payments.triangle=sifa.mtpl) hz.chl=clmplus(sifa.mtpl.rtt, 'a') #> Warning: StMoMo: 66 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 11  #> StMoMo: Start fitting with gnm #> Warning: non-integer x = 860.063891 #> Warning: non-integer x = 458.156066 #> Warning: non-integer x = 559.340054 #> Warning: non-integer x = 281.869679 #> Warning: non-integer x = 456.270650 #> Warning: non-integer x = 727.142070 #> Warning: non-integer x = 49353.589600 #> Warning: non-integer x = 50605.820000 #> Warning: non-integer x = 29251.193380 #> Warning: non-integer x = 36106.295210 #> Warning: non-integer x = 40125.390780 #> Warning: non-integer x = 44498.942240 #> Warning: non-integer x = 45490.189570 #> Warning: non-integer x = 48040.321560 #> Warning: non-integer x = 49991.357650 #> Warning: non-integer x = 49694.294990 #> Warning: non-integer x = 20880.666980 #> Warning: non-integer x = 18304.246140 #> Warning: non-integer x = 18603.713030 #> Warning: non-integer x = 12463.983790 #> Warning: non-integer x = 13441.333110 #> Warning: non-integer x = 12951.176400 #> Warning: non-integer x = 15370.423630 #> Warning: non-integer x = 15339.426370 #> Warning: non-integer x = 17842.901760 #> Warning: non-integer x = 19570.203660 #> Warning: non-integer x = 10047.067150 #> Warning: non-integer x = 8201.559214 #> Warning: non-integer x = 8833.487780 #> Warning: non-integer x = 5144.085289 #> Warning: non-integer x = 5868.234632 #> Warning: non-integer x = 6033.755464 #> Warning: non-integer x = 5593.853546 #> Warning: non-integer x = 5478.076757 #> Warning: non-integer x = 7035.199194 #> Warning: non-integer x = 3933.606063 #> Warning: non-integer x = 5749.890057 #> Warning: non-integer x = 4714.168250 #> Warning: non-integer x = 2726.947823 #> Warning: non-integer x = 2881.972323 #> Warning: non-integer x = 3009.655856 #> Warning: non-integer x = 2615.516340 #> Warning: non-integer x = 2540.639658 #> Warning: non-integer x = 2906.368627 #> Warning: non-integer x = 2725.682936 #> Warning: non-integer x = 3312.691467 #> Warning: non-integer x = 2359.362462 #> Warning: non-integer x = 2421.987896 #> Warning: non-integer x = 1264.396267 #> Warning: non-integer x = 1984.311792 #> Warning: non-integer x = 2136.804699 #> Warning: non-integer x = 1294.338023 #> Warning: non-integer x = 2266.599873 #> Warning: non-integer x = 1333.856105 #> Warning: non-integer x = 918.004039 #> Warning: non-integer x = 1249.952517 #> Warning: non-integer x = 1134.706143 #> Warning: non-integer x = 1184.355428 #> Warning: non-integer x = 1124.336355 #> Warning: non-integer x = 1238.429974 #> Warning: non-integer x = 1075.978340 #> Warning: non-integer x = 733.741025 #> Warning: non-integer x = 904.371165 #> Warning: non-integer x = 872.633331 #> Warning: non-integer x = 941.440475 #> StMoMo: Finish fitting with gnm"},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit Chain Ladder Plus to reverse time triangles. — clmplus.default","title":"Fit Chain Ladder Plus to reverse time triangles. — clmplus.default","text":"Default method fit Chain Ladder plus models.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit Chain Ladder Plus to reverse time triangles. — clmplus.default","text":"","code":"# Default S3 method clmplus(   AggregateDataPP,   hazard.model = NULL,   link = c(\"log\", \"logit\"),   staticAgeFun = TRUE,   periodAgeFun = \"NP\",   cohortAgeFun = NULL,   effect_log_scale = TRUE,   constFun = function(ax, bx, kt, b0x, gc, wxt, ages) list(ax = ax, bx = bx, kt = kt, b0x     = b0x, gc = gc),   ... )"},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit Chain Ladder Plus to reverse time triangles. — clmplus.default","text":"AggregateDataPP AggregateDataPP object, reverse time triangle fitted. hazard.model character, hazard model supported package. model can chosen : '': Age model, equivalent Mack chain-ladder. 'ac': Age cohort effects. 'ap': Age cohort effects. 'apc': Age cohort period effects. link character, defines link function random component associated mortality model. \"log\" assume deaths follow Poisson distribution use log link \"logit\" assume deaths follow Binomial distribution logit link. disregarded unless practitioner specifies hazard model StMoMo. staticAgeFun logical, indicates static age function \\(\\alpha_x\\) included. disregarded unless practitioner specifies hazard model StMoMo. periodAgeFun list, list length \\(N\\) definitions period age modulating parameters \\(\\beta_x^{()}\\). entry can take values: \"NP\" non-parametric age terms, \"1\" \\(\\beta_x^{()}=1\\) predefined parametric function age (see details). Set NULL period terms model. disregarded unless practitioner specifies hazard model StMoMo. cohortAgeFun character function, defines cohort age modulating parameter \\(\\beta_x^{(0)}\\). can take values: \"NP\" non-parametric age terms, \"1\" \\(\\beta_x^{(0)}=1\\), predefined parametric function age (see details) NULL cohort effect. disregarded unless practitioner specifies hazard model StMoMo. effect_log_scale logical, whether effects logarithmic scale. default, TRUE. constFun function, defines identifiability constraints model. must function form constFun <- function(ax, bx, kt, b0x, gc, wxt, ages) taking set fitted model parameters returning list list(ax = ax, bx = bx, kt = kt, b0x = b0x, gc = gc) model parameters identifiability constraints applied. omitted identifiability constraints applied model. disregarded unless practitioner specifies hazard model StMoMo. ... parameters passed clmplus.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit Chain Ladder Plus to reverse time triangles. — clmplus.default","text":"return value, called pass method clmplus.AggregateDataPP. See clmplus.AggregateDataPP documentation.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.default.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fit Chain Ladder Plus to reverse time triangles. — clmplus.default","text":"Pittarello, Gabriele, Munir Hiabu, Andrés M. Villegas. \"Replicating extending chain ladder via age-period-cohort structure claim development run-triangle.\" arXiv preprint arXiv:2301.03858 (2023). Hiabu, Munir. “relationship classical chain ladder granular reserving.” Scandinavian Actuarial Journal 2017 (2017): 708 - 729.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit Chain Ladder plus on Run-off Triangles. — clmplus","title":"Fit Chain Ladder plus on Run-off Triangles. — clmplus","text":"Method Estimate Chain Ladder plus models.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit Chain Ladder plus on Run-off Triangles. — clmplus","text":"","code":"clmplus(   AggregateDataPP,   hazard.model = NULL,   link = c(\"log\", \"logit\"),   staticAgeFun = TRUE,   periodAgeFun = \"NP\",   cohortAgeFun = NULL,   effect_log_scale = TRUE,   constFun = function(ax, bx, kt, b0x, gc, wxt, ages) list(ax = ax, bx = bx, kt = kt, b0x     = b0x, gc = gc),   ... )"},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit Chain Ladder plus on Run-off Triangles. — clmplus","text":"AggregateDataPP AggregateDataPP object, reverse time triangle fitted. hazard.model character, hazard model supported package. model can chosen : '': Age model, equivalent Mack chain-ladder. 'ac': Age cohort effects. 'ap': Age cohort effects. 'apc': Age cohort period effects. link character, defines link function random component associated mortality model. \"log\" assume deaths follow Poisson distribution use log link \"logit\" assume deaths follow Binomial distribution logit link. disregarded unless practitioner specifies hazard model StMoMo. staticAgeFun logical, indicates static age function \\(\\alpha_x\\) included. disregarded unless practitioner specifies hazard model StMoMo. periodAgeFun list, list length \\(N\\) definitions period age modulating parameters \\(\\beta_x^{()}\\). entry can take values: \"NP\" non-parametric age terms, \"1\" \\(\\beta_x^{()}=1\\) predefined parametric function age (see details). Set NULL period terms model. disregarded unless practitioner specifies hazard model StMoMo. cohortAgeFun character function, defines cohort age modulating parameter \\(\\beta_x^{(0)}\\). can take values: \"NP\" non-parametric age terms, \"1\" \\(\\beta_x^{(0)}=1\\), predefined parametric function age (see details) NULL cohort effect. disregarded unless practitioner specifies hazard model StMoMo. effect_log_scale logical, whether effects logarithmic scale. default, TRUE. constFun function, defines identifiability constraints model. must function form constFun <- function(ax, bx, kt, b0x, gc, wxt, ages) taking set fitted model parameters returning list list(ax = ax, bx = bx, kt = kt, b0x = b0x, gc = gc) model parameters identifiability constraints applied. omitted identifiability constraints applied model. disregarded unless practitioner specifies hazard model StMoMo. ... parameters passed clmplus.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit Chain Ladder plus on Run-off Triangles. — clmplus","text":"return value, called pass method clmplus.AggregateDataPP. See clmplus.AggregateDataPP documentation.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fit Chain Ladder plus on Run-off Triangles. — clmplus","text":"Pittarello, Gabriele, Munir Hiabu, Andrés M. Villegas. \"Replicating extending chain ladder via age-period-cohort structure claim development run-triangle.\" arXiv preprint arXiv:2301.03858 (2023).","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/clmplus.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit Chain Ladder plus on Run-off Triangles. — clmplus","text":"","code":"data(sifa.mtpl) sifa.mtpl.rtt <- AggregateDataPP(cumulative.payments.triangle=sifa.mtpl) hz.chl=clmplus(sifa.mtpl.rtt, 'a') #> Warning: StMoMo: 66 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 11  #> StMoMo: Start fitting with gnm #> Warning: non-integer x = 860.063891 #> Warning: non-integer x = 458.156066 #> Warning: non-integer x = 559.340054 #> Warning: non-integer x = 281.869679 #> Warning: non-integer x = 456.270650 #> Warning: non-integer x = 727.142070 #> Warning: non-integer x = 49353.589600 #> Warning: non-integer x = 50605.820000 #> Warning: non-integer x = 29251.193380 #> Warning: non-integer x = 36106.295210 #> Warning: non-integer x = 40125.390780 #> Warning: non-integer x = 44498.942240 #> Warning: non-integer x = 45490.189570 #> Warning: non-integer x = 48040.321560 #> Warning: non-integer x = 49991.357650 #> Warning: non-integer x = 49694.294990 #> Warning: non-integer x = 20880.666980 #> Warning: non-integer x = 18304.246140 #> Warning: non-integer x = 18603.713030 #> Warning: non-integer x = 12463.983790 #> Warning: non-integer x = 13441.333110 #> Warning: non-integer x = 12951.176400 #> Warning: non-integer x = 15370.423630 #> Warning: non-integer x = 15339.426370 #> Warning: non-integer x = 17842.901760 #> Warning: non-integer x = 19570.203660 #> Warning: non-integer x = 10047.067150 #> Warning: non-integer x = 8201.559214 #> Warning: non-integer x = 8833.487780 #> Warning: non-integer x = 5144.085289 #> Warning: non-integer x = 5868.234632 #> Warning: non-integer x = 6033.755464 #> Warning: non-integer x = 5593.853546 #> Warning: non-integer x = 5478.076757 #> Warning: non-integer x = 7035.199194 #> Warning: non-integer x = 3933.606063 #> Warning: non-integer x = 5749.890057 #> Warning: non-integer x = 4714.168250 #> Warning: non-integer x = 2726.947823 #> Warning: non-integer x = 2881.972323 #> Warning: non-integer x = 3009.655856 #> Warning: non-integer x = 2615.516340 #> Warning: non-integer x = 2540.639658 #> Warning: non-integer x = 2906.368627 #> Warning: non-integer x = 2725.682936 #> Warning: non-integer x = 3312.691467 #> Warning: non-integer x = 2359.362462 #> Warning: non-integer x = 2421.987896 #> Warning: non-integer x = 1264.396267 #> Warning: non-integer x = 1984.311792 #> Warning: non-integer x = 2136.804699 #> Warning: non-integer x = 1294.338023 #> Warning: non-integer x = 2266.599873 #> Warning: non-integer x = 1333.856105 #> Warning: non-integer x = 918.004039 #> Warning: non-integer x = 1249.952517 #> Warning: non-integer x = 1134.706143 #> Warning: non-integer x = 1184.355428 #> Warning: non-integer x = 1124.336355 #> Warning: non-integer x = 1238.429974 #> Warning: non-integer x = 1075.978340 #> Warning: non-integer x = 733.741025 #> Warning: non-integer x = 904.371165 #> Warning: non-integer x = 872.633331 #> Warning: non-integer x = 941.440475 #> StMoMo: Finish fitting with gnm"},{"path":"https://gpitt71.github.io/clmplus/reference/plot.AggregateDataPP.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the payments behavior — plot.AggregateDataPP","title":"Plot the payments behavior — plot.AggregateDataPP","text":"function allows define behavior triangle payments.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/plot.AggregateDataPP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the payments behavior — plot.AggregateDataPP","text":"","code":"# S3 method for class 'AggregateDataPP' plot(x, ...)"},{"path":"https://gpitt71.github.io/clmplus/reference/plot.AggregateDataPP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the payments behavior — plot.AggregateDataPP","text":"x AggregateDataPP plotted. ... Arguments passed plot.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/plot.AggregateDataPP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the payments behavior — plot.AggregateDataPP","text":"return value, plots run-triangle cumulative payments incremental payments.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/plot.AggregateDataPP.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Plot the payments behavior — plot.AggregateDataPP","text":"Pittarello, Gabriele, Munir Hiabu, Andrés M. Villegas. \"Replicating extending chain ladder via age-period-cohort structure claim development run-triangle.\" arXiv preprint arXiv:2301.03858 (2023).","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/plot.AggregateDataPP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the payments behavior — plot.AggregateDataPP","text":"","code":"data(sifa.mtpl) sifa.mtpl.pp <- AggregateDataPP(cumulative.payments.triangle=sifa.mtpl) plot(sifa.mtpl.pp) #> Warning: Removed 66 rows containing missing values or values outside the scale range #> (`geom_line()`). #> Warning: Removed 66 rows containing missing values or values outside the scale range #> (`geom_line()`)."},{"path":"https://gpitt71.github.io/clmplus/reference/plot.clmplusmodel.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the hazard model residuals — plot.clmplusmodel","title":"Plot the hazard model residuals — plot.clmplusmodel","text":"function allows plot hazard model residuals triangle payments.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/plot.clmplusmodel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the hazard model residuals — plot.clmplusmodel","text":"","code":"# S3 method for class 'clmplusmodel' plot(x, heat.lim = c(-2.5, 2.5), ...)"},{"path":"https://gpitt71.github.io/clmplus/reference/plot.clmplusmodel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the hazard model residuals — plot.clmplusmodel","text":"x clmplusmodel object, model fit plot. heat.lim limits residuals plot. ... Extra arguments passed plot function.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/plot.clmplusmodel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the hazard model residuals — plot.clmplusmodel","text":"return value, plots hazard model residuals triangular form.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/plot.clmplusmodel.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Plot the hazard model residuals — plot.clmplusmodel","text":"Pittarello, Gabriele, Munir Hiabu, Andrés M. Villegas. \"Replicating extending chain ladder via age-period-cohort structure claim development run-triangle.\" arXiv preprint arXiv:2301.03858 (2023).","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/plot.clmplusmodel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the hazard model residuals — plot.clmplusmodel","text":"","code":"data(sifa.mtpl) sifa.mtpl.rtt <- AggregateDataPP(cumulative.payments.triangle=sifa.mtpl) clm.fit<-clmplus(sifa.mtpl.rtt, 'a') #> Warning: StMoMo: 66 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 11  #> StMoMo: Start fitting with gnm #> Warning: non-integer x = 860.063891 #> Warning: non-integer x = 458.156066 #> Warning: non-integer x = 559.340054 #> Warning: non-integer x = 281.869679 #> Warning: non-integer x = 456.270650 #> Warning: non-integer x = 727.142070 #> Warning: non-integer x = 49353.589600 #> Warning: non-integer x = 50605.820000 #> Warning: non-integer x = 29251.193380 #> Warning: non-integer x = 36106.295210 #> Warning: non-integer x = 40125.390780 #> Warning: non-integer x = 44498.942240 #> Warning: non-integer x = 45490.189570 #> Warning: non-integer x = 48040.321560 #> Warning: non-integer x = 49991.357650 #> Warning: non-integer x = 49694.294990 #> Warning: non-integer x = 20880.666980 #> Warning: non-integer x = 18304.246140 #> Warning: non-integer x = 18603.713030 #> Warning: non-integer x = 12463.983790 #> Warning: non-integer x = 13441.333110 #> Warning: non-integer x = 12951.176400 #> Warning: non-integer x = 15370.423630 #> Warning: non-integer x = 15339.426370 #> Warning: non-integer x = 17842.901760 #> Warning: non-integer x = 19570.203660 #> Warning: non-integer x = 10047.067150 #> Warning: non-integer x = 8201.559214 #> Warning: non-integer x = 8833.487780 #> Warning: non-integer x = 5144.085289 #> Warning: non-integer x = 5868.234632 #> Warning: non-integer x = 6033.755464 #> Warning: non-integer x = 5593.853546 #> Warning: non-integer x = 5478.076757 #> Warning: non-integer x = 7035.199194 #> Warning: non-integer x = 3933.606063 #> Warning: non-integer x = 5749.890057 #> Warning: non-integer x = 4714.168250 #> Warning: non-integer x = 2726.947823 #> Warning: non-integer x = 2881.972323 #> Warning: non-integer x = 3009.655856 #> Warning: non-integer x = 2615.516340 #> Warning: non-integer x = 2540.639658 #> Warning: non-integer x = 2906.368627 #> Warning: non-integer x = 2725.682936 #> Warning: non-integer x = 3312.691467 #> Warning: non-integer x = 2359.362462 #> Warning: non-integer x = 2421.987896 #> Warning: non-integer x = 1264.396267 #> Warning: non-integer x = 1984.311792 #> Warning: non-integer x = 2136.804699 #> Warning: non-integer x = 1294.338023 #> Warning: non-integer x = 2266.599873 #> Warning: non-integer x = 1333.856105 #> Warning: non-integer x = 918.004039 #> Warning: non-integer x = 1249.952517 #> Warning: non-integer x = 1134.706143 #> Warning: non-integer x = 1184.355428 #> Warning: non-integer x = 1124.336355 #> Warning: non-integer x = 1238.429974 #> Warning: non-integer x = 1075.978340 #> Warning: non-integer x = 733.741025 #> Warning: non-integer x = 904.371165 #> Warning: non-integer x = 872.633331 #> Warning: non-integer x = 941.440475 #> StMoMo: Finish fitting with gnm plot(clm.fit)"},{"path":"https://gpitt71.github.io/clmplus/reference/plot.clmpluspredictions.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the hazard model fitted and forecasted parameters — plot.clmpluspredictions","title":"Plot the hazard model fitted and forecasted parameters — plot.clmpluspredictions","text":"function allows define behavior triangle payments.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/plot.clmpluspredictions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the hazard model fitted and forecasted parameters — plot.clmpluspredictions","text":"","code":"# S3 method for class 'clmpluspredictions' plot(x, cy.type = \"fe\", ...)"},{"path":"https://gpitt71.github.io/clmplus/reference/plot.clmpluspredictions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the hazard model fitted and forecasted parameters — plot.clmpluspredictions","text":"x clmpluspredictions, Model effects (fitted extrapolated) plotted. cy.type character, whether show fitted period effect without extrapolatio Default \"fe\", standing fitted extrapolated. Alternative specify \"f\" fitted effect. ... Arguments passed plot.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/plot.clmpluspredictions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the hazard model fitted and forecasted parameters — plot.clmpluspredictions","text":"return value, plots coefficients hazard models.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/plot.clmpluspredictions.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Plot the hazard model fitted and forecasted parameters — plot.clmpluspredictions","text":"Pittarello, G., Hiabu, M., & Villegas, . M. (2023). Replicating extending chain-ladder via age-period-cohort structure claim development run-triangle. arXiv preprint arXiv:2301.03858.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/plot.clmpluspredictions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the hazard model fitted and forecasted parameters — plot.clmpluspredictions","text":"","code":"data(sifa.mtpl) sifa.mtpl.rtt <- AggregateDataPP(cumulative.payments.triangle=sifa.mtpl) clm.fit<-clmplus(sifa.mtpl.rtt, 'a') #> Warning: StMoMo: 66 missing values which have been zero weighted #> StMoMo: The following ages have been zero weigthed: 1  #> StMoMo: The following years have been zero weigthed: 1  #> StMoMo: The following cohorts have been zero weigthed: -11 -10 -9 -8 -7 -6 -5 -4 -3 -2 -1 11  #> StMoMo: Start fitting with gnm #> Warning: non-integer x = 860.063891 #> Warning: non-integer x = 458.156066 #> Warning: non-integer x = 559.340054 #> Warning: non-integer x = 281.869679 #> Warning: non-integer x = 456.270650 #> Warning: non-integer x = 727.142070 #> Warning: non-integer x = 49353.589600 #> Warning: non-integer x = 50605.820000 #> Warning: non-integer x = 29251.193380 #> Warning: non-integer x = 36106.295210 #> Warning: non-integer x = 40125.390780 #> Warning: non-integer x = 44498.942240 #> Warning: non-integer x = 45490.189570 #> Warning: non-integer x = 48040.321560 #> Warning: non-integer x = 49991.357650 #> Warning: non-integer x = 49694.294990 #> Warning: non-integer x = 20880.666980 #> Warning: non-integer x = 18304.246140 #> Warning: non-integer x = 18603.713030 #> Warning: non-integer x = 12463.983790 #> Warning: non-integer x = 13441.333110 #> Warning: non-integer x = 12951.176400 #> Warning: non-integer x = 15370.423630 #> Warning: non-integer x = 15339.426370 #> Warning: non-integer x = 17842.901760 #> Warning: non-integer x = 19570.203660 #> Warning: non-integer x = 10047.067150 #> Warning: non-integer x = 8201.559214 #> Warning: non-integer x = 8833.487780 #> Warning: non-integer x = 5144.085289 #> Warning: non-integer x = 5868.234632 #> Warning: non-integer x = 6033.755464 #> Warning: non-integer x = 5593.853546 #> Warning: non-integer x = 5478.076757 #> Warning: non-integer x = 7035.199194 #> Warning: non-integer x = 3933.606063 #> Warning: non-integer x = 5749.890057 #> Warning: non-integer x = 4714.168250 #> Warning: non-integer x = 2726.947823 #> Warning: non-integer x = 2881.972323 #> Warning: non-integer x = 3009.655856 #> Warning: non-integer x = 2615.516340 #> Warning: non-integer x = 2540.639658 #> Warning: non-integer x = 2906.368627 #> Warning: non-integer x = 2725.682936 #> Warning: non-integer x = 3312.691467 #> Warning: non-integer x = 2359.362462 #> Warning: non-integer x = 2421.987896 #> Warning: non-integer x = 1264.396267 #> Warning: non-integer x = 1984.311792 #> Warning: non-integer x = 2136.804699 #> Warning: non-integer x = 1294.338023 #> Warning: non-integer x = 2266.599873 #> Warning: non-integer x = 1333.856105 #> Warning: non-integer x = 918.004039 #> Warning: non-integer x = 1249.952517 #> Warning: non-integer x = 1134.706143 #> Warning: non-integer x = 1184.355428 #> Warning: non-integer x = 1124.336355 #> Warning: non-integer x = 1238.429974 #> Warning: non-integer x = 1075.978340 #> Warning: non-integer x = 733.741025 #> Warning: non-integer x = 904.371165 #> Warning: non-integer x = 872.633331 #> Warning: non-integer x = 941.440475 #> StMoMo: Finish fitting with gnm clm <- predict(clm.fit) plot(clm) #> Warning: Removed 1 row containing missing values or values outside the scale range #> (`geom_line()`)."},{"path":"https://gpitt71.github.io/clmplus/reference/predict.clmplusmodel.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict the Reserve using Chain Ladder Plus Models — predict.clmplusmodel","title":"Predict the Reserve using Chain Ladder Plus Models — predict.clmplusmodel","text":"Predict lower triangle clmplus model.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/predict.clmplusmodel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict the Reserve using Chain Ladder Plus Models — predict.clmplusmodel","text":"","code":"# S3 method for class 'clmplusmodel' predict(   object,   gk.fc.model = \"a\",   ckj.fc.model = \"a\",   gk.order = c(1, 1, 0),   ckj.order = c(0, 1, 0),   forecasting_horizon = NULL,   ... )"},{"path":"https://gpitt71.github.io/clmplus/reference/predict.clmplusmodel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict the Reserve using Chain Ladder Plus Models — predict.clmplusmodel","text":"object clmplusmodel, Model predict . gk.fc.model character, model forecast cohort component last accident period. can either arima ('') linear model ('l'). Disregarded models cohort effect. ckj.fc.model character, model forecast calendar period effect. can either arima ('') linear model ('l'). Disregarded models period effect. gk.order integer, order arima model drift accident year effect extrapolation. Default (1,1,0). ckj.order integer, order arima model drift calendar year effect extrapolation. Default (0,1,0). forecasting_horizon integer, 1 triangle width. Calendar periods ahead predictions. Default predictions run-. ... Extra arguments passed predict function.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/predict.clmplusmodel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict the Reserve using Chain Ladder Plus Models — predict.clmplusmodel","text":"Returns following output:  reserve numeric reserve accident period. ultimate_cost numeric ultimate cost accident period. full_triangle matrix array complete run-triangle cumulative payments, includes (input) upper triangle predicted (output) lower triangle. lower_triangle matrix array predicted lower triangle cumulative payments. development_factors_predicted matrix array predicted lower triangle extrapolated development factors. apc_output list following output age-period-cohort representation: model.fit (fitStMoMo) age-period-cohort model fit.   alphaij (matrix array) predicted claim development.   lower_triangle_apc (matrix array) predicted lower triangle cumulative payments age-period-cohort form.   development_factors_apc (matrix array) development factors age-period-cohort representation.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/predict.clmplusmodel.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Predict the Reserve using Chain Ladder Plus Models — predict.clmplusmodel","text":"Pittarello, Gabriele, Munir Hiabu, Andrés M. Villegas. \"Replicating extending chain ladder via age-period-cohort structure claim development run-triangle.\" arXiv preprint arXiv:2301.03858 (2023).","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/sifa.gtpl.html","id":null,"dir":"Reference","previous_headings":"","what":"Sifa GTPL — sifa.gtpl","title":"Sifa GTPL — sifa.gtpl","text":"Dataset cumulative paid claims medium italian company line business: general third party liability.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/sifa.gtpl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sifa GTPL — sifa.gtpl","text":"","code":"sifa.gtpl"},{"path":"https://gpitt71.github.io/clmplus/reference/sifa.gtpl.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sifa GTPL — sifa.gtpl","text":"Run-triangle 12 development periods.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/sifa.gtpl.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sifa GTPL — sifa.gtpl","text":"Savelli, Nino,  Clemente, Gian Paolo. \"Lezioni di matematica attuariale delle assicurazioni danni.\" EDUCatt-Ente per il diritto allo studio universitario dell'Università Cattolica, 2014","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/sifa.mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Sifa MOD — sifa.mod","title":"Sifa MOD — sifa.mod","text":"Dataset cumulative paid claims medium italian company line business: motor damage.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/sifa.mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sifa MOD — sifa.mod","text":"","code":"sifa.mod"},{"path":"https://gpitt71.github.io/clmplus/reference/sifa.mod.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sifa MOD — sifa.mod","text":"Run-triangle 12 development periods.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/sifa.mod.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sifa MOD — sifa.mod","text":"Savelli, Nino, Clemente, Gian Paolo. \"Lezioni di matematica attuariale delle assicurazioni danni.\" EDUCatt-Ente per il diritto allo studio universitario dell'Università Cattolica, 2014","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/sifa.mtpl.html","id":null,"dir":"Reference","previous_headings":"","what":"Sifa MTPL — sifa.mtpl","title":"Sifa MTPL — sifa.mtpl","text":"Dataset cumulative paid claims medium italian company line business: motor third party liability.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/sifa.mtpl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sifa MTPL — sifa.mtpl","text":"","code":"sifa.mtpl"},{"path":"https://gpitt71.github.io/clmplus/reference/sifa.mtpl.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sifa MTPL — sifa.mtpl","text":"Run-triangle 12 development periods.","code":""},{"path":"https://gpitt71.github.io/clmplus/reference/sifa.mtpl.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Sifa MTPL — sifa.mtpl","text":"Savelli, Nino, Clemente, Gian Paolo. \"Lezioni di matematica attuariale delle assicurazioni danni.\" EDUCatt-Ente per il diritto allo studio universitario dell'Università Cattolica, 2014","code":""}]
